# Backend API Specification for NeTuArk

> This file is auto-generated by AI from the React frontend only.  Frontend naming is preserved where necessary to map UI â†’ backend.  All identifiers are placeholders â€“ backend engineers may rename while keeping structure intact.

---

## Legend
| Emoji | Section |
|-------|---------|
| ğŸ—ºï¸ | Route overview |
| ğŸ” | Access / roles |
| ğŸ–¥ï¸ | Backend-relevant UI elements |
| ğŸ—„ï¸ | Data schema |
| ğŸ”‚ | User flow |
| âš™ï¸ | Backend requirements |
| ğŸ“¥ | Request examples |
| ğŸ“¤ | Response examples |
| ğŸ—ƒï¸ | State & data handling |

All arrays are `[]` when empty, all dates ISO-8601.

---

## 1. Public Routes

### 1.1 `/`  *Landing*
ğŸ—ºï¸  Show marketing hero + dynamic previews.

ğŸ”  â€¢ Anonymous (âœ…) â€¢ Authenticated (âœ…; identical)

ğŸ–¥ï¸  Buttons: *Get started* â†’ `/register`; *Explore* â†’ `/explore`
Lists:
* Trending topic cards
* Popular community cards

ğŸ—„ï¸  `TrendingTopic`, `Community` (see shared models)

ğŸ”‚  ```javascript
GET /explore/trending            // 6 items
GET /communities?limit=6         // 6 items
```

âš™ï¸  
| Method | Path | Purpose | Notes |
|--------|------|---------|-------|
| GET | /explore/trending | list topics | public |
| GET | /communities | list communities | supports `page,limit,search` |

ğŸ—ƒï¸  Stateless; backend must deliver lightweight payloads; pagination optional.

---

### 1.2 `/login`  *Login Page*

ğŸ—ºï¸  Email/password & social-login.

ğŸ”  â€¢ Anonymous (âœ…) â€¢ Authenticated redirect `/feed`

ğŸ–¥ï¸  Inputs: `email`, `password`, `rememberMe`; Social: Google / GitHub â€¦

ğŸ—„ï¸  
| Field | Type | Req | Validation |
|-------|------|-----|------------|
| email | string | âœ… | RFC 5322 |
| password | string | âœ… | 8-128 chars |
| rememberMe | boolean | âŒ | â€” |

ğŸ”‚  ```javascript
POST /auth/login { email, password, rememberMe }
GET  /auth/oauth/{provider}
```

âš™ï¸  See endpoint table at bottom.

ğŸ—ƒï¸  JWT issued; refresh token if `rememberMe`.

---

### 1.3 `/register`  *Registration*
ğŸ–¥ï¸  `realName`, `username`, `email`, `password`, `confirmPassword`, `acceptTerms` (checkbox)

ğŸ—„ï¸  
| Field | Type | Req | Validation | Notes |
|-------|------|-----|------------|-------|
| realName | string | âœ… | 1-60 chars | |
| username | string | âœ… | `^[a-z0-9_]{3,20}$` | unique |
| email | string | âœ… | email | unique |
| password | string | âœ… | 8-128 chars, 1 upper,1 digit | |
| confirmPassword | string | âœ… | must match password | not stored |
| acceptTerms | boolean | âœ… | must be true | |

ğŸ”‚  `POST /auth/register` â†’ sends email verification.

âš™ï¸  Returns `{ user, message }`; no token until OTP verified.

---

### 1.4 `/verify-otp`
ğŸ–¥ï¸  `email`, `otp`

ğŸ—„ï¸  
| Field | Type | Req |
|-------|------|-----|
| email | string | âœ… |
| otp | string | âœ… | 6-digit |

ğŸ”‚  `POST /auth/verify-otp` â†’ returns accessToken + user.

---

### 1.5 `/forgot-password`
ğŸ–¥ï¸  `email`

ğŸ”‚  `POST /auth/forgot-password` â†’ sends reset link / code.

### 1.6 `/reset-password`
Query: `token=<resetToken>`
Inputs: `newPassword`, `confirmPassword`

ğŸ”‚  `POST /auth/reset-password`  `{ token, newPassword }`

---

### 1.7 `/explore`
Lists: Trending Topics, Recommended Communities (auth only)

Endpoints:
* `GET /explore/trending`
* (auth) `GET /explore/recommended-communities`

---

## 2. Protected Routes  *(JWT required)*

### 2.1 `/feed`
Tabbed timeline: `all | following | communities` + create-post modal.

ğŸ–¥ï¸  â€¢ Infinite list of `Post` cards  â€¢ Button âœ *Create Post* modal  â€¢ Comments drawer  â€¢ Tabs switch.

ğŸ—„ï¸  `Post`, `Comment`, `Reaction`

ğŸ”‚  
```
GET  /feed?page=1&type=all
POST /posts                     // create
POST /posts/:id/like            // reaction
GET  /posts/:id/comments?page=1
POST /posts/:id/comments        // add comment
```

### Create Post Modal

Purpose: Allows an authenticated user to publish a new post that can contain text, media, a poll, or an event configuration.

**Fields**

| Field | Type | Required | Purpose | Notes |
|------|------|----------|---------|-------|
| `content` | string | Yes* | Main body text for the post | Required unless `mediaFiles` or poll/event data is supplied |
| `mediaFiles[]` | file | Conditional | Image or video attachments | Multipart upload; multiple allowed |
| `postType` | enum | Yes | Validation & rendering strategy | `text`, `image`, `video`, `poll`, `event` |
| `privacy` | enum | Yes | Audience visibility | `public`, `friends`, `private` |
| `location` | string | No | Geographical tag | Free-text |
| `tags[]` | string | No | Hashtags to boost discoverability | Up to 10; each â‰¤ 30 chars |

*Required when no other content (media/poll/event) exists.

**Endpoint**

| Method | Path | Purpose | Auth | Notes |
|--------|------|---------|------|-------|
| POST | `/posts` | Create a new post using the above schema | Yes | Use `multipart/form-data` when files included |

---

### 2.2 `/search`

Purpose: Unified search endpoint returning paginated results across entity types.

**Query Parameters**

| Param | Type | Required | Purpose | Example |
|-------|------|----------|---------|---------|
| `q` | string | Yes | Search keyword | music |
| `type` | enum | No | Restrict results to an entity category | `users`, `posts`, `communities`, `hashtags`, `all` |
| `page` | int | No | Page number for pagination | 2 |

**Endpoint**

| Method | Path | Purpose | Auth | Notes |
|--------|------|---------|------|-------|
| GET | `/search` | Returns filtered, paginated search data | Yes | Rate-limited |

---

### 2.3 `/notifications`
Filter: `all | unread | mentions`; bulk actions.

Endpoints:
* `GET /notifications?page=1`
* `PUT /notifications/:id/read`
* `PUT /notifications/read-all`

---

### 2.4 `/messages`
Chat list + messages + group-create modal.

Endpoints:
* `GET /chats`
* `GET /chats/:chatId/messages?page=1`
* `POST /chats/:chatId/messages`  `{ content, type }`
* `POST /chats` (for new DM) / `POST /groups` (group)
* WebSocket `/ws/chat` for realtime (suggested)

---

### 2.5 `/communities`
Listing + search + pagination + join/leave.

Endpoints:
* `GET /communities?page=1&search=`
* `POST /communities`  (create)
* `POST /communities/{slug}/join`
* `POST /communities/{slug}/leave`

---

### 2.6 `/profile/:username`
Shows user, posts, follow/unfollow, stats.

Endpoints:
* `GET /users/{username}`
* `GET /users/{userId}/posts?page=1`
* `POST /users/{userId}/follow`
* `POST /users/{userId}/unfollow`

Followers & Following pages:
* `GET /users/{userId}/followers`
* `GET /users/{userId}/following`

---

### 2.7 `/settings`
Tabs: profile, password, notifications, business analytics.

#### Profile Tab
Fields: `name, bio, location, website, avatar(file)`
Endpoint: `PUT /users/profile`

#### Password Tab
Fields: `currentPassword, newPassword, confirmPassword`
Endpoint: `PUT /users/password`

#### Notifications Tab
Various boolean toggles (email, push, etc.)
Endpoint: `PUT /users/notifications`

#### Business Tab
Read-only analytics â€“ `GET /analytics?range=7d`

---

### 2.8 `/drafts`
Local-only today; backend may store user drafts.
Suggested endpoint:
* `GET /drafts`
* `POST /drafts`
* `DELETE /drafts/:id`

### 2.9 `/schedule`
Schedule existing draft or new post.

Fields: `title, content, scheduledDate, scheduledTime, timezone, community, tags[]`
Endpoint:
* `POST /scheduled-posts`  (create/update)
* `GET  /scheduled-posts`
* `DELETE /scheduled-posts/:id`

---

## 3. Shared Models

### 3.1 User
```
_id: UUID
username: string (unique, 3-20)
realName: string
email: string (unique)
passwordHash: string
avatarUrl?: URL
bio?: string
location?: string
website?: URL
createdAt, updatedAt: datetime
```

### 3.2 Post
```
_id, authorId(FKâ†’User), content, mediaUrls[], postType, privacy,
location?, tags[], createdAt, updatedAt, likeCount, commentCount
```

### 3.3 Comment
```
_id, postId(FKâ†’Post), authorId, content, createdAt, parentId?
```

### 3.4 Community, TrendingTopic, Notification, Chat, Message, Draft, ScheduledPost â€¦ (see per-route specs)

---

## 4. Endpoint Master List

| Method | Endpoint | Purpose | Auth | Notes |
|--------|----------|---------|------|-------|
| GET | /explore/trending | trending topics | âŒ | limit param |
| GET | /communities | list communities | âŒ | page,search |
| POST | /communities | create | âœ… | body CommunityCreate |
| POST | /communities/{slug}/join | join | âœ… | |
| POST | /communities/{slug}/leave | leave | âœ… | |
| GET | /auth/profile | current user | âœ… | JWT |
| POST | /auth/register | sign up | âŒ | sends OTP |
| POST | /auth/verify-otp | verify email | âŒ | returns JWT |
| POST | /auth/login | sign in | âŒ | |
| GET | /auth/oauth/{provider} | social signin | âŒ | |
| POST | /auth/logout | logout | âœ… | revoke refresh |
| POST | /auth/forgot-password | send reset mail | âŒ | |
| POST | /auth/reset-password | reset pw | âŒ | token in body |
| GET | /feed | timeline | âœ… | page,type |
| POST | /posts | create post | âœ… | multipart |
| POST | /posts/{id}/like | like/unlike | âœ… | |
| GET | /posts/{id}/comments | list comments | âœ… | page |
| POST | /posts/{id}/comments | add comment | âœ… | |
| GET | /search | global search | âœ… | q,type,page |
| GET | /notifications | list | âœ… | page |
| PUT | /notifications/{id}/read | mark | âœ… | |
| PUT | /notifications/read-all | mark all | âœ… | |
| GET | /chats | list chats | âœ… | |
| GET | /chats/{id}/messages | list msgs | âœ… | page |
| POST | /chats/{id}/messages | send msg | âœ… | |
| GET | /users/{username} | profile | âœ… | public maybe |
| GET | /users/{id}/followers | followers | âœ… | |
| GET | /users/{id}/following | following | âœ… | |
| POST | /users/{id}/follow | follow | âœ… | |
| POST | /users/{id}/unfollow | unfollow | âœ… | |
| PUT | /users/profile | update profile | âœ… | |
| PUT | /users/password | change pw | âœ… | |
| PUT | /users/notifications | prefs | âœ… | |
| GET | /analytics | stats | âœ… | range param |
| GET | /drafts | user drafts | âœ… | optional |
| POST | /drafts | save draft | âœ… | |
| DELETE | /drafts/{id} | remove | âœ… | |
| GET | /scheduled-posts | list scheduled | âœ… | |
| POST | /scheduled-posts | create/update | âœ… | |
| DELETE | /scheduled-posts/{id} | delete | âœ… | |

---

## 5. Error & Validation Rules
Standard JSON error wrapper
```jsonc
{ "error": "Message", "code": 400, "details": { ... } }
```
â€¢ 400 â€“ validation, 401 â€“ auth, 403 â€“ permission, 404 â€“ not found, 429 â€“ rate-limit, 500 â€“ server.

---

### END OF SPEC
